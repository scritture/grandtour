<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Claudio Comandini">

<title>Grand Tour - Ballate e danze dal Basso Impero</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Grand Tour</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Ricerca"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Attiva/disattiva la navigazione" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../diario.html#category=Claudio Comandini"> 
<span class="menu-text">Claudio Comandini</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../scritture.html"> 
<span class="menu-text">Scritture</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">contatti</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/groups/4880518/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/tweet_scritture"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/search/scritturemagazine"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:grandtour.frascati@gmail.com"> <i class="bi bi-envelope" role="img" aria-label="Email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ballate e danze dal Basso Impero</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Claudio Comandini</div>
                <div class="quarto-category">letteratura</div>
                <div class="quarto-category">musica</div>
                <div class="quarto-category">narrazioni</div>
              </div>
                  </div>
  </div>
  <div class="quarto-title-meta">
      <div>
      <div class="quarto-title-meta-heading">di</div>
      <div class="quarto-title-meta-contents">
               <p>Claudio Comandini </p>
            </div>
    </div>
      <div>
      <div class="quarto-title-meta-heading">Data di Pubblicazione</div>
      <div class="quarto-title-meta-contents">
        <p class="date">9 maggio 2012</p>
      </div>
    </div>
    </div>
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In questa pagina</h2>
  <ul>
  <li><a href="#aprile-1994" id="toc-aprile-1994" class="nav-link active" data-scroll-target="#aprile-1994">25 APRILE 1994</a></li>
  <li><a href="#gioia" id="toc-gioia" class="nav-link" data-scroll-target="#gioia">GIOIA</a></li>
  <li><a href="#cronache-dal-basso-impero" id="toc-cronache-dal-basso-impero" class="nav-link" data-scroll-target="#cronache-dal-basso-impero">CRONACHE DAL BASSO IMPERO</a></li>
  <li><a href="#il-diario" id="toc-il-diario" class="nav-link" data-scroll-target="#il-diario">IL DIARIO</a></li>
  <li><a href="#come-in-un-sogno" id="toc-come-in-un-sogno" class="nav-link" data-scroll-target="#come-in-un-sogno">COME IN UN SOGNO</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<div class="quarto-about-marquee content">
  <div class="about-image-container">
    <img src="/images/2012/05/telegono-1-494x381.jpg" class="about-image " style="width: 100%;">
  </div>
  <div class="about-contents">
     <main class="content quarto-banner-title-block" id="quarto-document-content">

<p><em>Una lettera dai tempi del conflitto generalizzato. Ritratto affettuoso di una ragazza futile. Cronache di ieri e di oggi. Note di diario. Sogni. Dal romanzo “Basso Impero”.</em></p>
<section id="aprile-1994" class="level3">
<h3 data-anchor-id="aprile-1994">25 APRILE 1994</h3>
<p>Ieri, notte. Sogno: è un altro giorno. Sono di fronte al Parlamento e scopro che ho perso le elezioni. Bombo, svagato più del solito, si reca a Montecitorio in virtù di deputato, e sento per me doveroso assistere alle discussioni: parlo con lui proprio di questo mio senso del dovere, e lui annuisce muovendo il testone, non so mica se mi ascolta però. Intanto nel Transatlantico è tutta una festa, con costumi sgargianti mossi in giochi e danze, e c’è un Cavaliere di Plastica che disputa un torneo con Paperino. Esco e ci intratteniamo a parlare con Craxi, assiso su di un trono in mezzo alla piazza; quando intendo affrontare l’argomento della sua perseguibilità giudiziaria, ha un moto di stizza. Incontro Ferrara, che dice di avere da fare e va al bar a mangiare tramezzini di pietre preziose. Nella 127 dell’ingegner Persichelli, compagno di scuola e di niente, passando sulla sopraelevata dei venti si discute della necessità di raccogliere le forze e fare una lista. Chiedo in sezione la tessera del partito, per ottenere la quale bisogna fare un versamento alla Barilla, lo sponsor della Roma.</p>
<p>I sogni hanno forme dense come pietre, e aperti gli occhi ci troviamo di fronte un pensiero un po’ meno rarefatto del sogno, un po’ più denso della fiction: la realtà, l’inganno più fitto, da reinventare daccapo. Da sognare di nuovo, forse. E si coagula l’uovo del mondo che si sgretola.</p>
<p>E siamo alle prese con le solite piccole storie, come dire, da basso impero. Per farla breve, così va: la politica assimila il gioco d’azzardo della finanza, l’informazione i ritmi sgangherati della telenovela, e non sai dove cominci una e finisca l’altra, assimilate a una pubblicità priva di prodotto. I nemici si alleano per dettarsi condizioni, gli alleati si scornano per ottenerle, vince il peggiore e ci attacchiamo al meno peggio. Se questa è la democrazia, sarebbe forse logico e opportuno seppellire definitivamente ogni inutile speranza e ogni velleità di partecipazione. A me non interessa lottare contro i mulini a vento, ma non capisco nemmeno quelli che li rincorrono, e comunque sarebbe più giusto prendere le armi contro un mare di guai, e contrastandoli, por fine ad essi, piuttosto che gettarcisi di continuo.</p>
<p>Intanto tu sei altrove. Potrei dirti che hai fatto bene a partire di nuovo, ma già lo sai. Laggiù dove sei chissà le risate a vedere da chi è rappresentato ’sto cazzo di paese. Del resto le parabole del potere riescono a chiarirsi solo nel tratto discendente: quello dell’incaprettatamento, non necessariamente ad una pompa di benzina. Intanto che aspetto, evito di farmi coinvolgere. Nulla di ciò che è perso torna più, ma è utile sopravvivere, non subire ricatti nella propria vita oltre a quelli a cui tutti siamo costretti; per quanto riguarda mettere a posto le cose, forse non basterebbero né la fine del mondo, né altri innumerevoli massacri di massa.</p>
<p>Oggi c’è pure la manifestazione. Quella grande. Cinquant’anni sono troppi per rimpiangere o per festeggiare la speranza e l’illusione: dovremmo pensare piuttosto a quanto istituzioni e funzionari di questo paese hanno mantenuto elementi e caratteri <em>più-che-fascista</em>, anche mentre si straparlava di retorico anti-fascismo e si imbrattavano importantissimi pezzi di carta come la Costituzione, che dovrebbe essere uno strumento operativo e non un feticcio. Ma di questi tempi ogni mito è menzogna, niente più dell’ennesima solenne celebrazione del vuoto. Come i Mondiali di calcio. Sai che palle, pure l’imbarazzo del tifo, per chi lo fa, per favorire i profitti di ricchi ignoranti e dei loro padroni ladroni, che è gente che farebbero meglio a prendersi a calci in culo da sola. Speriamo di perdere di brutto, o al primo turno o alla finale, magari ai rigori. Shock, forse terapeutico, comunque inevitabile. Probabilmente inutile.</p>
<p>Intanto che in Italia attendiamo un altro ridicolo miracolo, pronti dopo una breve illusione a sporcarsi di nuovo le mani, Inghilterra e America gettano il resto del mondo nella loro rovina, in Russia stanno peggio di quando stavano male, gli Slavi del sud sono dilaniati da privatizzazioni e guerra, il Ruanda implode e piovono bombe sulla prima elezione in Sudafrica, Israele continua a seminare morti per le sue bibliche fissazioni, l’Islam preme da ogni granello del suo e del nostro deserto. E altre polveriere si preparano. Il conflitto generalizzato come forma di convivenza. Tutti contro tutti in nome di niente. L’impazzimento locale della maionese globale. L’uovo del mondo alla fase terminale. Altro che nuovo ordine mondiale.</p>
</section>
<section id="gioia" class="level3">
<h3 data-anchor-id="gioia">GIOIA</h3>
<p>(https://soundcloud.com/claudio_comandini/gioia)</p>
<p>Gioia vuole bene a tutti, e gli sta bene così. Lei è così, rossa così, pienotta cosi. Il suo pomeriggio trascorre fra le immagini della tv i cosmetici e le telefonate. Lei adora Fiorello come una muta che attende da lui la voce, e tutte le canzono le ha imparate da lui. È&nbsp;amica di Ambra, certo, gli batte le mani quando si muove così ben telecomandata, ma non ha il suo stile, non fa la saccente con quella forzata disinvoltura che piace tanto ai frustrati. Questo lo sa. Ma non si cura di capire. Cambia ad ogni notiziario, poi figurati oggi che c’è sta manifestazione, cheppalle. La guarda un po’, ma poi si rompe, e canta le sigle pubblicitarie. E prega che i Take That non si scioglino mai, lei prega che i Take That non si sciogliano mai. Esce un giorno con me e un giorno con te, e dà a tutti quel che gli và. Lei adesso ha quindici anni, e non gliene importa un granché. Si sente grande, sa di essere piccola. Guarda la borgata fuori, non pensa che sia brutta. Tra un po’ esce con Mario, stasera forse farà pace con Lele, magari stasera andrà a ballare. Fuori la pioggia ha smesso, ma può ricominciare, ma non gli importa.</p>
</section>
<section id="cronache-dal-basso-impero" class="level3">
<h3 data-anchor-id="cronache-dal-basso-impero">CRONACHE DAL BASSO IMPERO</h3>
<p>(https://soundcloud.com/claudio_comandini/cronache-dal-basso-impero)</p>
<p>Credi davvero che siamo in un’epoca peggiore delle altre, oppure che esista un progresso? Stavo interessandomi alla tarda antichità: alla vita quotidiana durante il basso impero. Ti sembra di sentire le grida di una folla perduta, concentrata in una piazza ricavata dal prosciugamento di una palude, dove la fogna passa a cielo aperto. Nell’ordinarietà del malaffare, la normalità del ladrocinio, in un’epoca di principi del foro bugiardi, di corti piene di puttane. Dove la popolazione è falciata dalle epidemie e dall’ordinaria violenza urbana, il fiume straborda, i rifiuti marciscono per strada, la speculazione edilizia riempie ogni vuoto. Incontrollata l’immigrazione di schiavi delle province, agricoltori senza più terra, che vendono e comprano mogli e figlie alla prostituzione nella suburra perché altro lavoro non c’è. E questi “extracomunitari” sono intrusi pericolosi per gli scaricatori del porto fluviale e i figli di buona famiglia, con cui condividono le stesse sbronze, le stesse chiacchiere, le stesse puttane. Insomma, ritrovo la storia dei nostri giorni. Come se già dai tempi di Roma vivessimo una lunga decadenza. Come se il basso impero non fosse mai finito.</p>
</section>
<section id="il-diario" class="level3">
<h3 data-anchor-id="il-diario">IL DIARIO</h3>
<p>Te stesso ed un foglio è specchio di una maschera con cui il vuoto si veste, quando parola è prossima al silenzio. In una di queste pause, nell’intimità del giorni, s’inscrive il diario, l’eterna quotidiana vicenda del ripiegamento di sé su se stessi. Come tutte le opere umane, cosa degna di sospetto.</p>
<p>Troppo coraggio e onestà esige l’osservazione di se stessi perché la sua espressione scritta non decada in sfogo, compiacimento, commiserazione. In una sorta di negativo fotografico del proprio rapporto con la realtà, come un inventario di scuse sulle proprie mancanze, una giustificazione delle proprie cazzate.</p>
<p>La giustificazione, forma di menzogna, è una delle più stupide ma la più continua delle attività mentali; in tale esclusivo universo l’uomo si rinchiude, reagendo meccanicamente a tutto ciò che accade. E anche le costruzione del pensiero e le architetture sintattiche diventano spesso l’ipocrita diario dell’umanità, la scrittura l’inventario delle sue giustificazioni, la cultura lo spoglio dei suoi equivoci.</p>
</section>
<section id="come-in-un-sogno" class="level3">
<h3 data-anchor-id="come-in-un-sogno">COME IN UN SOGNO</h3>
<p>https://soundcloud.com/claudio_comandini/gioia</p>
<p>La televisione è spenta, staccata la spina. Sul muro c’è un calendario senza giorni e vengono gli operai a fare i lavori. Ho le tasche piene di monete. E Serena mi porta un supplì. Con Jimmy Santorini troviamo una bella canna di bambù e la regaliamo al creatore, che la usa per fare il male. Allora gliela togliamo e la regaliamo a un poverello.</p>
<p><em>Brani tratti e adattati da: Claudio Comandini, “Basso Impero”, Sovera, Roma 2006, pp.&nbsp;9-10, 22, _35-36, 40, 48;</em> <em>Registrazioni: Sound Club, Marino, maggio 2007.</em> <em>Fotografia: Claudio Comandini, “Telegonus” – Frascati, maggio&nbsp;1988.</em></p>


</section>
</main> 
  </div>
</div>
 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/grandtour\.shop");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>